var path = require('path');
var JEngineBuilder = module.exports = function (options) {
  var self = this;
  Backbone.history.start({root: document.location.toString()});
  _.each(this.constructor.Routers, function (router, name) {
    self.Routers[name] = new router;
  });
};

_.extend(JEngineBuilder, {
  Routers: browserRequire('./routers'),
  
  Views: browserRequire('./views'),

  Project: browserRequire('./classes/project')
});

_.extend(JEngineBuilder.prototype, {
  setActiveView: function (view) {
    if (this.ActiveView) {
      this.ActiveView.undelegateEvents();
      this.ActiveView.stopListening();
      this.ActiveView.removeAttr('data-page');
    }
    this.activeView = view;
    this.activeView.$el.attr({'data-page': view.name});
    return this.activeView;
  },
  
  Routers: {},

  start: function () {
    Backbone.history.loadUrl();
    return this;
  }
});